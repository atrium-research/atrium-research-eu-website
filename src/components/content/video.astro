---
import { createUrl, createUrlSearchParams } from "@acdh-oeaw/lib";

interface Props {
	caption?: string;
	provider: "youtube";
	id: string;
	startTime?: number;
}

const { caption, id, startTime } = Astro.props;

const href = String(
	createUrl({
		baseUrl: "https://www.youtube-nocookie.com",
		pathname: `/embed/${id}`,
		searchParams: startTime ? createUrlSearchParams({ t: startTime }) : undefined,
	}),
);
---

<figure class="flex flex-col gap-y-1.5">
	<iframe
		allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
		allowfullscreen
		class="aspect-video w-full overflow-hidden rounded-lg"
		referrerpolicy="strict-origin-when-cross-origin"
		src={href}
		title={caption ?? "Video"}></iframe>
	{caption ? <figcaption class="text-red-clay">{caption}</figcaption> : null}
</figure>
